{
  "widget": {
    "typeFullFqn": "system.cards.html_value_card",
    "type": "latest",
    "sizeX": 7.5,
    "sizeY": 3,
    "config": {
      "datasources": [
        {
          "type": "entity",
          "name": "",
          "deviceId": "b0fce8a0-f0ef-11f0-ab82-673c8923e718",
          "entityAliasId": "af6723ab-6405-7c14-1da8-4abc31a51584",
          "dataKeys": [
            {
              "name": "fv_p_in",
              "type": "timeseries",
              "label": "fv_p_in",
              "color": "#2196f3",
              "settings": {},
              "_hash": 0.23196667372748148
            },
            {
              "name": "grid_p_import",
              "type": "timeseries",
              "label": "grid_p_import",
              "color": "#f44336",
              "settings": {},
              "_hash": 0.3536996003313114
            },
            {
              "name": "house_p_load",
              "type": "timeseries",
              "label": "house_p_load",
              "color": "#ffc107",
              "settings": {},
              "_hash": 0.169050229413102
            },
            {
              "name": "wind_p_dc",
              "type": "timeseries",
              "label": "wind_p_dc",
              "color": "#8bc34a",
              "settings": {},
              "_hash": 0.41813719343888456
            },
            {
              "name": "batt_soc",
              "type": "timeseries",
              "label": "batt_soc",
              "color": "#3f51b5",
              "settings": {},
              "_hash": 0.27392083739088846
            },
            {
              "name": "batt_p",
              "type": "timeseries",
              "label": "batt_p",
              "color": "#e91e63",
              "settings": {},
              "_hash": 0.8050768455633454
            },
            {
              "name": "p_auto",
              "type": "timeseries",
              "label": "p_auto",
              "color": "#8bc34a",
              "settings": {},
              "_hash": 0.24652886139690044
            }
          ],
          "alarmFilterConfig": {
            "statusList": [
              "ACTIVE"
            ]
          }
        }
      ],
      "timewindow": {
        "displayValue": "",
        "selectedTab": 0,
        "realtime": {
          "realtimeType": 1,
          "interval": 1000,
          "timewindowMs": 60000,
          "quickInterval": "CURRENT_DAY",
          "hideInterval": false,
          "hideLastInterval": false,
          "hideQuickInterval": false
        },
        "history": {
          "historyType": 0,
          "interval": 1000,
          "timewindowMs": 60000,
          "fixedTimewindow": {
            "startTimeMs": 1769447178549,
            "endTimeMs": 1769533578549
          },
          "quickInterval": "CURRENT_DAY",
          "hideInterval": false,
          "hideLastInterval": false,
          "hideFixedInterval": false,
          "hideQuickInterval": false
        },
        "aggregation": {
          "type": "AVG",
          "limit": 25000
        }
      },
      "showTitle": false,
      "backgroundColor": null,
      "color": "rgba(0, 0, 0, 0.87)",
      "padding": "0",
      "settings": {
        "cardHtml": "<div class=\"scada-container\">\r\n    <svg\r\n  class=\"scada-svg\"\r\n  viewBox=\"0 0 1920 1080\"\r\n  preserveAspectRatio=\"xMidYMid meet\"\r\n>\r\n<rect width=\"1920\" height=\"1080\" fill=\"white\"/>\r\n<path d=\"M1464 223.107L1497.72 200.681L1464 173.739L1430.28 200.681L1464 223.107ZM1478.52 232.787L1515.14 257.148L1508.37 212.943L1478.52 232.787ZM1449.48 232.787L1419.63 212.943L1412.86 257.148L1449.48 232.787ZM1429.96 146.473L1423.99 185.032L1451.09 163.413L1429.96 146.473ZM1432.54 129.533C1433.99 129.695 1435.44 130.34 1436.73 131.308L1464 153.088L1491.27 131.308C1492.56 130.34 1494.01 129.695 1495.46 129.533H1432.54ZM1504.01 185.032L1498.04 146.473L1476.91 163.413L1504.01 185.032ZM1568.87 113.4V145.667H1552.73V129.533H1511.75L1536.6 290.867L1464 242.467L1391.4 290.867L1416.25 129.533H1375.27V145.667H1359.13V113.4H1418.67L1423.67 81.1333H1504.33L1509.33 113.4H1568.87ZM1434.96 113.4H1493.04L1490.46 97.2666H1437.54L1434.96 113.4Z\" fill=\"#7493AA\"/>\r\n<path id=\"line-solar\" class=\"scada-line\" d=\"M1397 282L1103 403\" stroke=\"#D0D0D0\" stroke-width=\"11\"/>\r\n<path d=\"M1586.51 575.259H1599.37V599.838H1586.51V575.259Z\" fill=\"#D0D0D0\"/>\r\n<path d=\"M1599.37 575.259H1608.07V599.838H1599.37V575.259Z\" fill=\"#94989B\"/>\r\n<path d=\"M1581.97 566.562H1603.53V575.259H1581.97V566.562Z\" fill=\"#D0D0D0\"/>\r\n<path d=\"M1603.53 566.562H1612.23V575.259H1603.53V566.562Z\" fill=\"#94989B\"/>\r\n<path d=\"M1555.51 566.562L1474.21 613.072H1637.18L1555.51 566.562Z\" fill=\"#ED4C5C\"/>\r\n<path d=\"M1497.28 613.072H1614.12V684.916H1497.28V613.072Z\" fill=\"#F9F3D9\"/>\r\n<path d=\"M1541.14 634.625H1570.25V663.741H1541.14V634.625Z\" fill=\"#D6EEF0\"/>\r\n<path d=\"M1537.36 630.844V667.144H1573.66V630.844H1537.36ZM1570.25 634.625V647.481H1557.4V634.625H1570.25ZM1553.99 634.625V647.481H1541.14V634.625H1553.99ZM1541.14 663.741V650.884H1553.99V663.741H1541.14ZM1557.4 663.741V650.884H1570.25V663.741H1557.4Z\" fill=\"#89664C\"/>\r\n<path d=\"M1488.2 713.653H1660.62V786.631H1488.2V713.653Z\" fill=\"#F9F3D9\"/>\r\n<path d=\"M1603.53 735.206H1632.64V764.322H1603.53V735.206Z\" fill=\"#D6EEF0\"/>\r\n<path d=\"M1599.75 731.803V768.103H1636.05V731.803H1599.75ZM1632.64 735.206V748.062H1619.79V735.206H1632.64ZM1616.01 735.206V748.062H1603.15V735.206H1616.01ZM1603.53 764.322V751.844H1616.38V764.7H1603.53V764.322ZM1619.79 764.322V751.844H1632.64V764.7H1619.79V764.322ZM1533.58 741.634H1565.34V786.253H1533.58V741.634Z\" fill=\"#89664C\"/>\r\n<path d=\"M1530.55 735.206H1568.74V741.634H1530.55V735.206Z\" fill=\"#DBB471\"/>\r\n<path d=\"M1560.04 763.188C1561.3 763.188 1562.31 762.172 1562.31 760.919C1562.31 759.666 1561.3 758.65 1560.04 758.65C1558.79 758.65 1557.78 759.666 1557.78 760.919C1557.78 762.172 1558.79 763.188 1560.04 763.188Z\" fill=\"#F9F3D9\"/>\r\n<path d=\"M1471.56 786.253H1698.44V793.437H1471.56V786.253Z\" fill=\"#83BF4F\"/>\r\n<path d=\"M1651.55 685.294H1496.9L1471.56 713.653H1677.26L1651.55 685.294Z\" fill=\"#ED4C5C\"/>\r\n<path d=\"M1698.44 771.506C1698.44 766.969 1695.03 763.566 1690.5 763.566C1689.74 763.566 1688.61 763.566 1687.85 763.944C1686.72 762.053 1684.83 760.541 1682.56 760.541C1681.04 760.541 1679.91 760.919 1678.78 761.675V760.541C1678.78 757.137 1676.13 754.491 1672.73 754.491C1669.7 754.491 1667.43 756.759 1666.68 759.406C1665.92 758.65 1665.16 758.65 1664.03 758.65C1661.76 758.65 1659.87 760.541 1659.87 762.809V786.631H1691.63C1695.03 786.631 1697.68 783.984 1697.68 780.581C1697.68 779.069 1696.93 777.556 1696.17 776.422C1697.68 774.909 1698.44 773.397 1698.44 771.506Z\" fill=\"#83BF4F\"/>\r\n<path d=\"M1698.44 780.203C1698.44 778.691 1697.68 777.178 1696.92 776.044C1698.06 774.531 1698.44 773.019 1698.44 771.128C1698.44 766.591 1695.03 763.188 1690.5 763.188C1689.74 763.188 1688.61 763.188 1687.85 763.566C1687.09 762.431 1686.34 761.297 1684.83 760.541C1682.56 761.297 1681.42 763.566 1681.42 765.834C1681.42 766.591 1681.42 766.969 1681.8 767.347C1681.42 766.969 1680.67 766.969 1679.91 766.969C1677.64 766.969 1675.75 768.859 1675.75 771.128C1675.75 772.641 1676.51 773.775 1678.02 774.531C1677.26 775.666 1676.51 777.178 1676.51 778.691C1676.51 782.472 1679.53 785.497 1683.31 785.497H1692.39C1695.79 786.253 1698.44 783.606 1698.44 780.203ZM1674.99 781.338C1674.99 783.606 1673.1 780.581 1670.83 780.581C1668.57 780.581 1666.67 783.606 1666.67 781.338C1666.67 779.069 1668.57 777.178 1670.83 777.178C1673.1 777.178 1674.99 779.069 1674.99 781.338ZM1666.3 774.531C1666.3 775.666 1665.54 774.531 1664.41 774.531C1663.27 774.531 1662.52 775.666 1662.52 774.531C1662.52 773.397 1663.27 772.641 1664.41 772.641C1665.16 772.263 1666.3 773.397 1666.3 774.531Z\" fill=\"#699635\"/>\r\n<path d=\"M1669.7 768.481C1669.7 769.616 1668.94 768.103 1667.81 768.103C1666.68 768.103 1665.92 769.616 1665.92 768.481C1665.92 767.347 1666.68 766.591 1667.81 766.591C1668.94 766.591 1669.7 767.347 1669.7 768.481ZM1686.34 778.312C1686.34 779.825 1685.2 777.556 1683.69 777.556C1682.18 777.556 1681.04 779.825 1681.04 778.312C1681.04 776.8 1682.18 775.666 1683.69 775.666C1684.82 775.666 1686.34 776.8 1686.34 778.312ZM1693.9 771.128C1693.9 773.397 1692.01 769.994 1689.74 769.994C1687.47 769.994 1685.58 773.397 1685.58 771.128C1685.58 768.859 1687.47 766.969 1689.74 766.969C1692.01 766.969 1693.9 768.859 1693.9 771.128ZM1693.9 780.581C1693.9 781.716 1693.14 780.581 1692.01 780.581C1690.88 780.581 1690.12 781.716 1690.12 780.581C1690.12 779.447 1690.88 778.691 1692.01 778.691C1693.14 778.691 1693.9 779.447 1693.9 780.581ZM1676.13 764.322C1676.13 765.834 1674.99 763.566 1673.48 763.566C1671.97 763.566 1670.83 765.834 1670.83 764.322C1670.83 762.809 1671.97 761.675 1673.48 761.675C1674.99 761.675 1676.13 762.809 1676.13 764.322ZM1509.38 771.506C1509.38 766.969 1505.97 763.566 1501.43 763.566C1500.68 763.566 1499.54 763.566 1498.79 763.944C1497.65 762.053 1495.76 760.541 1493.49 760.541C1491.98 760.541 1490.85 760.919 1489.71 761.675V760.541C1489.71 757.137 1487.07 754.491 1483.66 754.491C1480.64 754.491 1478.37 756.759 1477.99 759.406C1477.23 758.65 1476.48 758.65 1475.34 758.65C1473.07 758.65 1471.56 760.541 1471.56 762.809V786.631H1503.32C1506.73 786.631 1509.38 783.984 1509.38 780.581C1509.38 779.069 1508.62 777.556 1507.86 776.422C1508.62 774.909 1509.38 773.397 1509.38 771.506Z\" fill=\"#83BF4F\"/>\r\n<path d=\"M1509.38 780.203C1509.38 778.691 1508.62 777.178 1507.86 776.044C1509 774.531 1509.38 773.019 1509.38 771.128C1509.38 766.591 1505.97 763.188 1501.43 763.188C1500.68 763.188 1499.54 763.188 1498.79 763.566C1498.03 762.431 1497.27 761.297 1495.76 760.541C1493.49 761.297 1492.36 763.566 1492.36 765.834C1492.36 766.591 1492.36 766.969 1492.74 767.347C1492.36 766.969 1491.6 766.969 1490.85 766.969C1488.58 766.969 1486.69 768.859 1486.69 771.128C1486.69 772.641 1487.44 773.775 1488.96 774.531C1488.2 775.666 1487.44 777.178 1487.44 778.691C1487.44 782.472 1490.47 785.497 1494.25 785.497H1503.32C1506.73 786.253 1509.38 783.606 1509.38 780.203ZM1485.93 781.338C1485.93 783.606 1484.04 780.581 1481.77 780.581C1479.5 780.581 1477.61 783.606 1477.61 781.338C1477.61 779.069 1479.5 777.178 1481.77 777.178C1484.04 777.178 1485.93 779.069 1485.93 781.338ZM1477.23 774.531C1477.23 775.666 1476.48 774.531 1475.34 774.531C1474.21 774.531 1473.45 775.666 1473.45 774.531C1473.45 773.397 1474.21 772.641 1475.34 772.641C1476.1 772.263 1477.23 773.397 1477.23 774.531Z\" fill=\"#699635\"/>\r\n<path d=\"M1480.64 768.481C1480.64 769.616 1479.88 768.103 1478.75 768.103C1477.61 768.103 1476.86 769.616 1476.86 768.481C1476.86 767.347 1477.61 766.591 1478.75 766.591C1479.5 766.591 1480.64 767.347 1480.64 768.481ZM1497.28 778.312C1497.28 779.825 1496.14 777.556 1494.63 777.556C1493.12 777.556 1491.98 779.825 1491.98 778.312C1491.98 776.8 1493.12 775.666 1494.63 775.666C1495.76 775.666 1497.28 776.8 1497.28 778.312ZM1504.84 771.128C1504.84 773.397 1502.95 769.994 1500.68 769.994C1498.41 769.994 1496.52 773.397 1496.52 771.128C1496.52 768.859 1498.79 766.969 1500.68 766.969C1502.95 766.969 1504.84 768.859 1504.84 771.128ZM1504.84 780.581C1504.84 781.716 1504.08 780.581 1502.95 780.581C1501.81 780.581 1501.06 781.716 1501.06 780.581C1501.06 779.447 1501.81 778.691 1502.95 778.691C1504.08 778.312 1504.84 779.447 1504.84 780.581ZM1487.07 764.322C1487.07 765.834 1485.93 763.566 1484.42 763.566C1482.91 763.566 1481.77 765.834 1481.77 764.322C1481.77 762.809 1482.91 761.675 1484.42 761.675C1485.93 761.675 1487.07 762.809 1487.07 764.322Z\" fill=\"#83BF4F\"/>\r\n<path d=\"M232.055 654.344C232.055 652.609 232.744 650.946 233.97 649.72C235.196 648.494 236.859 647.805 238.594 647.805H256.031C257.766 647.805 259.429 648.494 260.655 649.72C261.881 650.946 262.57 652.609 262.57 654.344C262.57 656.078 261.881 657.741 260.655 658.968C259.429 660.194 257.766 660.883 256.031 660.883H238.594C236.859 660.883 235.196 660.194 233.97 658.968C232.744 657.741 232.055 656.078 232.055 654.344ZM274.384 603.481C274.989 604.096 275.71 604.586 276.505 604.922C277.301 605.257 278.155 605.432 279.018 605.436C279.881 605.44 280.736 605.273 281.535 604.945C282.333 604.617 283.059 604.134 283.669 603.524C284.28 602.914 284.764 602.189 285.093 601.391C285.422 600.593 285.59 599.738 285.587 598.875C285.584 598.011 285.41 597.157 285.076 596.362C284.741 595.566 284.252 594.845 283.637 594.239L271.289 581.902C270.042 580.796 268.42 580.209 266.755 580.259C265.089 580.309 263.505 580.993 262.327 582.171C261.149 583.349 260.465 584.933 260.415 586.598C260.365 588.264 260.953 589.886 262.058 591.133L274.384 603.481ZM334.5 582.414C336.234 582.414 337.898 581.725 339.124 580.499C340.35 579.273 341.039 577.609 341.039 575.875V558.438C341.039 556.703 340.35 555.04 339.124 553.814C337.898 552.587 336.234 551.898 334.5 551.898C332.766 551.898 331.103 552.587 329.876 553.814C328.65 555.04 327.961 556.703 327.961 558.438V575.875C327.961 577.609 328.65 579.273 329.876 580.499C331.103 581.725 332.766 582.414 334.5 582.414ZM389.984 605.399C390.844 605.4 391.696 605.23 392.491 604.901C393.286 604.572 394.008 604.089 394.616 603.481L406.942 591.133C408.047 589.886 408.635 588.264 408.585 586.598C408.535 584.933 407.851 583.349 406.673 582.171C405.495 580.993 403.911 580.309 402.245 580.259C400.58 580.209 398.958 580.796 397.711 581.902L385.363 594.239C384.45 595.153 383.828 596.318 383.576 597.586C383.324 598.853 383.454 600.167 383.948 601.361C384.443 602.556 385.28 603.576 386.354 604.295C387.428 605.014 388.691 605.398 389.984 605.399ZM406.43 654.344C406.43 656.078 407.119 657.741 408.345 658.968C409.571 660.194 411.234 660.883 412.969 660.883H430.406C432.141 660.883 433.804 660.194 435.03 658.968C436.256 657.741 436.945 656.078 436.945 654.344C436.945 652.609 436.256 650.946 435.03 649.72C433.804 648.494 432.141 647.805 430.406 647.805H412.969C411.234 647.805 409.571 648.494 408.345 649.72C407.119 650.946 406.43 652.609 406.43 654.344ZM290.906 660.883C292.641 660.883 294.304 660.194 295.53 658.968C296.756 657.741 297.445 656.078 297.445 654.344C297.445 644.516 301.349 635.091 308.298 628.142C315.247 621.193 324.672 617.289 334.5 617.289C344.328 617.289 353.753 621.193 360.702 628.142C367.651 635.091 371.555 644.516 371.555 654.344C371.555 656.078 372.244 657.741 373.47 658.968C374.696 660.194 376.359 660.883 378.094 660.883C379.828 660.883 381.491 660.194 382.718 658.968C383.944 657.741 384.633 656.078 384.633 654.344C384.633 641.048 379.351 628.296 369.949 618.895C360.548 609.493 347.796 604.211 334.5 604.211C321.204 604.211 308.452 609.493 299.051 618.895C289.649 628.296 284.367 641.048 284.367 654.344C284.367 656.078 285.056 657.741 286.282 658.968C287.509 660.194 289.172 660.883 290.906 660.883ZM453.489 779.676C452.917 780.667 452.094 781.491 451.103 782.065C450.113 782.639 448.989 782.942 447.844 782.945H221.156C220.014 782.944 218.892 782.644 217.902 782.075C216.912 781.506 216.088 780.687 215.513 779.701C214.937 778.714 214.63 777.594 214.622 776.452C214.614 775.31 214.906 774.186 215.467 773.191L259.813 694.722C260.383 693.713 261.211 692.873 262.213 692.289C263.215 691.705 264.353 691.397 265.513 691.398H403.487C404.647 691.397 405.785 691.705 406.787 692.289C407.789 692.873 408.617 693.713 409.187 694.722L453.533 773.191C454.09 774.183 454.379 775.302 454.371 776.439C454.364 777.576 454.06 778.692 453.489 779.676ZM399.673 704.477H369.157L373.898 726.273H412.042L399.673 704.477ZM360.504 726.273L355.763 704.477H313.259L308.518 726.273H360.504ZM305.652 739.352L299.015 769.867H369.985L363.348 739.352H305.652ZM257.001 726.273H295.146L299.887 704.477H269.371L257.001 726.273ZM232.36 769.867H285.631L292.269 739.352H249.612L232.36 769.867ZM436.64 769.867L419.388 739.352H376.731L383.369 769.867H436.64Z\" fill=\"#F5EA1F\"/>\r\n<path id=\"line-eolico\" class=\"scada-line\" d=\"M454 769L881 552\" stroke=\"#D0D0D0\" stroke-width=\"11\"/>\r\n<path d=\"M462.347 303.583V291.875H480.354V223.58C476.81 222.753 473.716 220.602 471.069 218.511C468.423 216.419 466.292 213.839 464.677 210.771L430.055 232.432L361.245 212.844V186.5H464.044C465.699 183.3 467.924 180.544 470.718 178.234C473.513 175.923 476.725 174.323 480.354 173.434V127.689L532.573 78.6663L555.042 92.7397L502.471 179.58C505.937 181.774 508.497 185.251 510.152 190.013C511.807 194.774 511.986 199.293 510.69 203.571L551.728 213.745L586.315 276.151L567.874 293.702L496.793 223.58C496.043 224.033 495.294 224.412 494.545 224.716C493.795 225.013 492.968 225.235 492.062 225.383V291.875H510.07V303.583H462.347ZM392.542 104.542V92.8333H451.083V104.542H392.542ZM492.062 132.759V173.527C492.109 173.527 492.144 173.539 492.168 173.562C492.191 173.586 492.223 173.597 492.262 173.597L539.189 96.4746L533.92 93.5358L492.062 132.759ZM357.417 151.375V139.667H404.25V151.375H357.417ZM486.173 212.165C490.115 212.165 493.432 210.834 496.125 208.172C498.818 205.503 500.165 202.193 500.165 198.243C500.165 194.302 498.834 190.984 496.172 188.291C493.503 185.598 490.193 184.252 486.243 184.252C482.302 184.252 478.984 185.587 476.291 188.256C473.598 190.918 472.252 194.224 472.252 198.173C472.252 202.115 473.587 205.432 476.256 208.125C478.918 210.818 482.224 212.165 486.173 212.165ZM427.831 219.869L460.907 199.426C460.86 199.2 460.836 198.997 460.836 198.817V198.208H372.954V204.063L427.831 219.869ZM543.942 223.814L505.621 214.401C505.527 214.487 505.437 214.6 505.351 214.741C505.258 214.873 505.168 214.986 505.082 215.08L567.195 277.579L571.585 273.247L543.942 223.814ZM380.833 280.167V268.458H427.667V280.167H380.833Z\" fill=\"#68B1E8\"/>\r\n<path id=\"line-red\" class=\"scada-line\" d=\"M542 307L885 403\" stroke=\"#D0D0D0\" stroke-width=\"11\"/>\r\n<path id=\"line-auto\" class=\"scada-line\" d=\"M955.5 583V769.5\" stroke=\"#D0D0D0\" stroke-width=\"11\"/>\r\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M955.093 391C940.399 391 928.683 391.556 919.679 392.276C909.592 393.078 902.052 401.068 901.544 411.957C900.834 427.095 900.167 449.503 900.167 480.127V556.271C900.167 561.075 904.062 565 908.949 565H1001.23C1002.38 565.004 1003.52 564.782 1004.58 564.346C1005.65 563.91 1006.62 563.268 1007.43 562.458C1008.25 561.648 1008.89 560.685 1009.34 559.624C1009.78 558.563 1010.01 557.425 1010.01 556.276V480.131C1010.01 449.503 1009.35 427.095 1008.64 411.957C1008.13 401.068 1000.59 393.078 990.506 392.276C981.502 391.556 969.781 391 955.093 391ZM918.142 373.001C927.678 372.247 939.911 371.667 955.093 371.667C970.274 371.667 982.498 372.242 992.043 373.001C1012.63 374.644 1027.03 391.266 1027.96 411.053C1028.68 426.515 1029.35 449.222 1029.35 480.131V533.148H1072.1C1074.58 533.148 1076.99 532.364 1079 530.908C1081 529.452 1082.49 527.4 1083.26 525.044C1084.02 522.689 1084.02 520.151 1083.26 517.795C1082.49 515.44 1081 513.386 1079 511.93L1070.03 505.41C1066.45 502.801 1063.53 499.38 1061.52 495.428C1059.5 491.476 1058.45 487.104 1058.45 482.669V454.07C1054.1 452.87 1050.09 450.663 1046.75 447.627C1041.18 442.504 1037.98 435.23 1037.92 426.713L1037.91 425.167C1037.91 417.868 1038.28 412.489 1038.75 408.569C1039.28 404.171 1041.48 400.657 1044.62 398.351V381.333C1044.62 378.77 1045.63 376.311 1047.45 374.498C1049.26 372.685 1051.72 371.667 1054.28 371.667C1056.85 371.667 1059.3 372.685 1061.12 374.498C1062.93 376.311 1063.95 378.77 1063.95 381.333V394.978C1066.73 394.947 1069.51 394.947 1072.29 394.978V381.333C1072.29 378.77 1073.31 376.311 1075.12 374.498C1076.94 372.685 1079.39 371.667 1081.96 371.667C1084.52 371.667 1086.98 372.685 1088.79 374.498C1090.61 376.311 1091.62 378.77 1091.62 381.333V398.347C1094.76 400.652 1096.96 404.161 1097.49 408.564C1097.97 412.479 1098.33 417.864 1098.33 425.162L1098.32 426.709C1098.26 435.225 1095.06 442.504 1089.49 447.622C1086.15 450.658 1082.14 452.865 1077.79 454.065V482.664C1077.79 485.477 1079.14 488.116 1081.41 489.769L1090.37 496.289C1095.67 500.148 1099.61 505.586 1101.64 511.824C1103.66 518.061 1103.66 524.779 1101.63 531.015C1099.6 537.251 1095.65 542.686 1090.35 546.541C1085.04 550.396 1078.66 552.474 1072.1 552.477H1029.34V556.276C1029.34 571.82 1016.73 584.333 1001.23 584.333H908.949C893.453 584.333 880.833 571.815 880.833 556.276V480.131C880.833 449.222 881.51 426.515 882.235 411.053C883.153 391.266 897.547 374.644 918.142 373.001ZM955.088 401.976C939.355 401.976 929.809 402.281 924.261 402.571C919.258 402.832 914.241 405.5 912.83 411.044C911.912 414.674 911.143 419.952 911.143 427.463C911.143 434.978 911.912 440.252 912.835 443.881C914.236 449.425 919.253 452.098 924.256 452.359C929.8 452.649 939.35 452.949 955.083 452.949C970.815 452.949 980.371 452.644 985.915 452.354C990.917 452.093 995.934 449.425 997.336 443.881C998.254 440.252 999.028 434.978 999.028 427.463C999.028 419.947 998.254 414.674 997.336 411.044C995.934 405.505 990.917 402.832 985.915 402.571C980.371 402.281 970.82 401.976 955.083 401.976M957.949 471.47C962.613 467.376 969.607 471.04 969.216 477.086C968.549 487.381 967.761 495.898 967.002 502.679C973.189 503.485 979.346 504.509 985.46 505.748C986.619 505.974 987.696 506.504 988.582 507.283C989.468 508.062 990.132 509.062 990.505 510.182C990.877 511.301 990.946 512.5 990.703 513.654C990.461 514.809 989.916 515.879 989.124 516.754C982.005 524.874 967.654 540.64 952.226 554.183C947.562 558.277 940.568 554.613 940.96 548.571C941.627 538.276 942.415 529.755 943.174 522.979C936.985 522.171 930.827 521.146 924.71 519.905C923.553 519.678 922.476 519.148 921.59 518.369C920.705 517.59 920.042 516.589 919.67 515.47C919.297 514.35 919.229 513.152 919.472 511.998C919.715 510.843 920.26 509.774 921.051 508.899C928.171 500.779 942.521 485.013 957.949 471.47Z\" fill=\"black\"/>\r\n<path id=\"line-bateria\" class=\"scada-line\" d=\"M1026 567L1484.5 735\" stroke=\"#D0D0D0\" stroke-width=\"11\"/>\r\n\r\n<path d=\"M1011.25 920.833V790.75C1011.25 780.501 1002.92 772.167 992.667 772.167H974.083V753.583H936.917V772.167H918.333C908.085 772.167 899.75 780.501 899.75 790.75V920.833C899.75 931.082 908.085 939.417 918.333 939.417H992.667C1002.92 939.417 1011.25 931.082 1011.25 920.833ZM918.333 920.833V790.75L992.667 790.731V920.833H918.333Z\" fill=\"black\"/>\r\n<g clip-path=\"url(#clip0_9_10)\">\r\n    \r\n<path d=\"M1013.45 106.293C1005.86 93.6708 995.42 82.9997 982.967 75.1333C977.355 71.5767 970.958 69.4478 964.334 68.9326C957.71 68.4174 951.061 69.5316 944.967 72.1777C939.636 74.6921 934.998 78.4662 931.452 83.1741C927.906 87.8821 925.56 93.3823 924.616 99.1999C924.278 101.269 923.982 103.422 923.729 105.111H919.507C918.06 105.094 916.624 105.365 915.283 105.907C913.941 106.449 912.721 107.252 911.692 108.269C910.663 109.286 909.846 110.497 909.289 111.832C908.731 113.167 908.444 114.6 908.444 116.047V152.147C908.444 153.11 908.827 154.033 909.508 154.714C910.189 155.395 911.113 155.778 912.076 155.778H919.38V154.131C919.369 150.222 920.299 146.367 922.092 142.893C923.885 139.418 926.487 136.427 929.68 134.17C932.872 131.913 936.561 130.458 940.434 129.927C944.307 129.396 948.251 129.805 951.933 131.12L947.711 135.342C944.339 134.722 940.863 135.013 937.642 136.186C934.42 137.359 931.571 139.371 929.387 142.013C928.261 143.143 927.358 144.475 926.727 145.94C925.428 148.454 924.706 151.227 924.616 154.055C924.525 156.883 925.068 159.696 926.204 162.288C927.339 164.88 929.04 167.186 931.181 169.036C933.321 170.887 935.849 172.236 938.578 172.985C941.307 173.734 944.168 173.864 946.954 173.365C949.74 172.867 952.379 171.752 954.678 170.103C956.978 168.454 958.88 166.312 960.246 163.833C961.612 161.355 962.407 158.603 962.573 155.778H985.711V154.131C985.703 150.227 986.633 146.377 988.423 142.908C990.214 139.438 992.812 136.449 995.999 134.194C999.186 131.938 1002.87 130.481 1006.74 129.946C1010.6 129.411 1014.54 129.814 1018.22 131.12L1014 135.342C1010.63 134.722 1007.15 135.013 1003.93 136.186C1000.71 137.359 997.859 139.371 995.676 142.013C994.55 143.143 993.647 144.475 993.016 145.94C991.734 148.454 991.029 151.221 990.95 154.042C990.872 156.862 991.423 159.665 992.563 162.246C993.703 164.827 995.403 167.121 997.541 168.963C999.678 170.805 1002.2 172.147 1004.92 172.893C1007.64 173.639 1010.49 173.77 1013.27 173.275C1016.05 172.781 1018.68 171.674 1020.98 170.035C1023.28 168.396 1025.18 166.266 1026.55 163.8C1027.92 161.334 1028.73 158.594 1028.9 155.778H1039.92C1040.89 155.778 1041.81 155.395 1042.49 154.714C1043.17 154.033 1043.56 153.11 1043.56 152.147V144.631C1043.52 135.801 1040.54 127.234 1035.09 120.289C1029.64 113.344 1022.02 108.418 1013.45 106.293ZM950.667 105.111H933.778C933.778 103.633 934.2 102.113 934.453 100.593C935.163 95.9773 937.035 91.6177 939.893 87.9245C942.752 84.2314 946.503 81.3261 950.793 79.4822L950.667 105.111ZM943.742 165.742C941.655 165.742 939.614 165.123 937.878 163.963C936.142 162.803 934.789 161.155 933.99 159.226C933.191 157.297 932.982 155.175 933.39 153.127C933.797 151.08 934.802 149.199 936.278 147.723C937.755 146.246 939.635 145.241 941.683 144.834C943.731 144.427 945.853 144.636 947.782 145.435C949.71 146.233 951.359 147.586 952.519 149.322C953.679 151.058 954.298 153.099 954.298 155.187C954.298 157.986 953.186 160.671 951.206 162.651C949.227 164.63 946.542 165.742 943.742 165.742ZM980.222 126.222H967.556V117.778H980.222V126.222ZM954.889 105.111V77.5399C962.822 76.4601 970.884 78.1769 977.689 82.3955C987.039 88.2731 995.086 96.0039 1001.33 105.111H954.889ZM1010.03 165.742C1007.94 165.742 1005.9 165.123 1004.17 163.963C1002.43 162.803 1001.08 161.155 1000.28 159.226C999.48 157.297 999.271 155.175 999.678 153.127C1000.09 151.08 1001.09 149.199 1002.57 147.723C1004.04 146.246 1005.92 145.241 1007.97 144.834C1010.02 144.427 1012.14 144.636 1014.07 145.435C1016 146.233 1017.65 147.586 1018.81 149.322C1019.97 151.058 1020.59 153.099 1020.59 155.187C1020.59 157.986 1019.47 160.671 1017.5 162.651C1015.52 164.63 1012.83 165.742 1010.03 165.742Z\" fill=\"#C62B2B\"/>\r\n\r\n<path d=\"M974 158.5L957.5 382\" stroke=\"white\" stroke-width=\"3\"/>\r\n<path d=\"M985.5 153L957.5 382\" stroke=\"white\"/>\r\n</g>\r\n<path id=\"line-casa\" class=\"scada-line\" d=\"M976 158L966 372\" stroke=\"#D0D0D0\" stroke-width=\"9\"/>\r\n<defs>\r\n<clipPath id=\"clip0_9_10\">\r\n<rect width=\"152\" height=\"152\" fill=\"white\" transform=\"translate(900 46)\"/>\r\n</clipPath>\r\n</defs>\r\n<g id=\"battery-status-group\">\r\n    <rect x=\"918\" y=\"790\" width=\"75\" height=\"130\" fill=\"none\" stroke=\"#ccc\" stroke-width=\"1\" />\r\n    \r\n    <rect \r\n        id=\"battery-fill\" \r\n        x=\"918\" \r\n        y=\"790\" \r\n        width=\"75\" \r\n        height=\"130\" \r\n        fill=\"orange\" \r\n        style=\"transition: all 0.5s ease-in-out;\"\r\n    />\r\n</g>\r\n</svg>\r\n\r\n<script>\r\nself.onDataUpdated = function () {\r\n    // 1. Intentar obtener los datos directamente del array de ThingsBoard\r\n    var datos = self.ctx.data;\r\n    var batt_p = 0;\r\n    var batt_soc = 0;\r\n\r\n    // Buscador manual para evitar errores de funciones externas\r\n    for (var i = 0; i < datos.length; i++) {\r\n        if (datos[i].dataKey.name === 'batt_p') {\r\n            if (datos[i].data && datos[i].data.length > 0) {\r\n                batt_p = datos[i].data[datos[i].data.length - 1][1];\r\n            }\r\n        }\r\n        if (datos[i].dataKey.name === 'batt_soc') {\r\n            if (datos[i].data && datos[i].data.length > 0) {\r\n                batt_soc = datos[i].data[datos[i].data.length - 1][1];\r\n            }\r\n        }\r\n    }\r\n\r\n    // 2. Referencia al elemento\r\n    var fill = document.getElementById(\"battery-fill\");\r\n\r\n    if (fill) {\r\n        // Forzamos que se detenga cualquier animación CSS que lo ponga naranja\r\n        fill.style.animation = \"none\";\r\n        fill.style.webkitAnimation = \"none\";\r\n\r\n        var maxHeight = 130;\r\n        var baseLineY = 920; \r\n\r\n        // 3. Lógica de seguridad: Si batt_soc llega vacío, ponemos 10% para ver que el script corre\r\n        var displaySoc = (batt_soc > 0) ? batt_soc : 10;\r\n        var calculatedHeight = (maxHeight * displaySoc) / 100;\r\n        \r\n        fill.setAttribute(\"height\", calculatedHeight);\r\n        fill.setAttribute(\"y\", baseLineY - calculatedHeight);\r\n\r\n        // 4. Color: Si no hay potencia, lo ponemos AZUL para saber que el script funciona\r\n        var color = \"#3498db\"; // Azul de diagnóstico\r\n        if (batt_p > 0.1) color = \"#2ecc71\"; // Verde\r\n        if (batt_p < -0.1) color = \"#e74c3c\"; // Rojo\r\n        \r\n        fill.setAttribute(\"fill\", color);\r\n    }\r\n};\r\n//BATERIA\r\n\r\n</script>\r\n    <div class=\"label\" style=\"top: 75%; left: 20%;\">Solar: ${fv_p_in} kW</div>\r\n    <div class=\"label\" style=\"top: 15%; left: 25%;\">Eólica: ${wind_p_dc} kW</div>\r\n    <div class=\"label\" style=\"top: 85%; left: 48%;\">Batería: ${batt_p} kW</div>\r\n    <div class=\"label\" style=\"top: 80%; left: 48%;\">${batt_soc} %</div>\r\n    <div class=\"label\" style=\"top: 75%; left: 80%;\">Casa: ${house_p_load} kW</div>\r\n    <div class=\"label\" style=\"top: 40%; left: 75%;\">Red: ${grid_p_import} kw</div>\r\n    <div class=\"label\" style=\"top: 10%; left: 55%;\">Auto: ${p_auto} kw</div>\r\n</div>\r\n",
        "cardCss": "@keyframes battery-pulse {\r\n    0% { opacity: 0.6; }\r\n    50% { opacity: 1; }\r\n    100% { opacity: 0.6; }\r\n}\r\n.scada-container {\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n}\r\n\r\n.scada-svg {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n/* ===== LINEAS ===== */\r\n.scada-line {\r\n  stroke-dasharray: 20;\r\n  animation: flow 1s linear infinite;\r\n  transition: stroke 0.4s ease;\r\n}\r\n\r\n/* Estados */\r\n.green { stroke: #2ecc71; }\r\n.red   { stroke: #e74c3c; }\r\n.gray  { stroke: #9e9e9e; }\r\n\r\n@keyframes flow {\r\n  from { stroke-dashoffset: 40; }\r\n  to   { stroke-dashoffset: 0; }\r\n}\r\n/* ===== ETIQUETAS ===== */\r\n.label {\r\n  position: absolute;\r\n  border-radius: 18px;\r\n  padding: 6px 14px;\r\n  font-family: 'Segoe UI', sans-serif;\r\n  font-weight: 600;\r\n  font-size: 14px;\r\n  transform: translate(-50%, -50%);\r\n  pointer-events: none;\r\n}\r\n\r\n@keyframes flow {\r\n  from { stroke-dashoffset: 40; }\r\n  to { stroke-dashoffset: 0; }\r\n}\r\n"
      },
      "title": "HTML Value Card",
      "dropShadow": false,
      "enableFullscreen": true,
      "widgetStyle": {},
      "titleStyle": {
        "fontSize": "16px",
        "fontWeight": 400
      },
      "useDashboardTimewindow": true,
      "showLegend": false,
      "actions": {},
      "displayTimewindow": true,
      "widgetCss": "",
      "pageSize": 1024,
      "units": "Wh",
      "noDataDisplayMessage": "",
      "margin": "0",
      "borderRadius": "0"
    },
    "row": 0,
    "col": 0,
    "id": "c935891e-3937-e32d-cbb7-1b43635a1513"
  },
  "aliasesInfo": {
    "datasourceAliases": {
      "0": {
        "alias": "Todos los equipos",
        "filter": {
          "type": "entityList",
          "resolveMultiple": true,
          "entityType": "DEVICE",
          "entityList": [
            "b0fce8a0-f0ef-11f0-ab82-673c8923e718",
            "1bbc2350-f0ef-11f0-ab82-673c8923e718",
            "d3282980-f0ef-11f0-ab82-673c8923e718",
            "c884c600-f0ef-11f0-ab82-673c8923e718",
            "bd7e5af0-f0ef-11f0-ab82-673c8923e718",
            "97f45eb0-f0ef-11f0-ab82-673c8923e718",
            "dab54380-001d-11f1-8f20-65f016ae1941"
          ]
        }
      }
    },
    "targetDeviceAlias": null
  },
  "filtersInfo": {
    "datasourceFilters": {}
  },
  "originalSize": {
    "sizeX": 9,
    "sizeY": 7.3636363636363615,
    "preserveAspectRatio": true,
    "resizable": true
  },
  "originalColumns": 24
}